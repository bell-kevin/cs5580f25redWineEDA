\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{graphicx}
\usepackage{siunitx}
\usepackage{float}
\usepackage{microtype}
\usepgfplotslibrary{statistics}
\pgfplotsset{compat=1.18,table/search path={data,../data}}
\pgfplotstableset{col sep=comma}
\sisetup{round-mode=places,round-precision=3,reset-text-series=false,text-series-to-math=true,reset-text-family=false,text-family-to-math=true}

\title{Exploratory Data Analysis of Red Wine Quality}
\author{\vspace{-1em}\small link to video presentation: \url{https://drive.google.com/file/d/1XDmwo9ll2Bka5LMx9keicMhuWUSi7VsB/view?usp=sharing}}
\date{Group members: Kevin Bell, Angelie Reyes-Sosa, and Dani Lopez}

\begin{document}
\maketitle

\begin{abstract}
This report documents a comprehensive exploratory data analysis (EDA) of the UCI
Machine Learning Repository's red wine quality dataset. The analysis examines
the physicochemical properties that influence perceived wine quality, evaluates
assumptions and hypotheses about the data generating process, and outlines next
steps for predictive modeling. All computations were performed with reproducible
Python scripts included in the project repository, and the figures in this
document are generated directly from the source data to avoid dependency on
binary assets.
\end{abstract}

\section{Introduction -- Data Description}
The red wine quality dataset comprises \num{1599} Portuguese \emph{Vinho Verde}
wines characterized by \num{11} physicochemical measurements and a sensory
quality rating on a \numrange{3}{8} integer scale. Each observation corresponds
to a unique laboratory analysis of a batch of wine. The dataset was selected
because it satisfies the course requirements (more than ten features and five
hundred observations), is publicly accessible without authentication, and has
been widely studied, enabling comparisons between this work and the broader data
science literature.

Table~\ref{tab:feature-definitions} summarizes the feature definitions.
The measurements capture acidity, residual sugars, sulfur compounds, alcohol
content, density, and pH. These factors collectively determine a wine's
structure, aromatic profile, and stability. The quality score, provided by
trained sensory assessors, serves as the primary response variable of interest.

\begin{table}[H]
  \centering
  \caption{Feature definitions and measurement units.}
  \label{tab:feature-definitions}
  \begin{tabular}{p{0.28\textwidth}p{0.62\textwidth}}
    \toprule
    \textbf{Feature} & \textbf{Description} \\
    \midrule
    Fixed acidity & Concentration of non-volatile acids (g/dm\textsuperscript{3}). \\
    Volatile acidity & Acetic acid content (g/dm\textsuperscript{3}); high values lead to vinegar flavors. \\
    Citric acid & Citric acid concentration (g/dm\textsuperscript{3}); adds freshness and structure. \\
    Residual sugar & Sugar remaining after fermentation (g/dm\textsuperscript{3}). \\
    Chlorides & Salt concentration (g/dm\textsuperscript{3}). \\
    Free sulfur dioxide & Free SO\textsubscript{2} (mg/dm\textsuperscript{3}); protects against oxidation and microbial spoilage. \\
    Total sulfur dioxide & Combined bound and free SO\textsubscript{2} (mg/dm\textsuperscript{3}). \\
    Density & Liquid density (g/cm\textsuperscript{3}), closely linked to sugar and alcohol levels. \\
    pH & Acidity level (unitless). \\
    Sulfates & Potassium sulfate concentration (g/dm\textsuperscript{3}); contributes to antimicrobial stability. \\
    Alcohol & Ethanol percentage by volume. \\
    Quality & Median of sensory panel ratings on a scale from three (poor) to eight (excellent). \\
    \bottomrule
  \end{tabular}
\end{table}

\section{Questions -- Assumptions -- Hypotheses}
The EDA prioritized the following data science questions:
\begin{enumerate}
  \item \textbf{Which physicochemical attributes most strongly distinguish higher-quality wines?} This question directly informs winemaking decisions aimed at improving quality and is therefore the top priority.
  \item \textbf{How do acidity profiles interact with sulfur compounds across quality levels?} Understanding these interactions aids in balancing freshness with microbial stability.
  \item \textbf{Are there latent subgroups of wines with distinct compositions that could motivate segmentation or targeted modeling?} Detecting subgroups supports tailored recommendations and motivates future clustering or predictive work.
\end{enumerate}

Two main assumptions underpin the analysis. First, sensory quality scores are
treated as approximately ordinal-continuous, enabling correlation and regression
interpretations. Second, laboratory measurements are assumed to be recorded
without systematic bias. Potential observer bias arises because the analysis
focuses on chemical drivers of quality and does not incorporate viticultural or
sensory descriptors beyond the provided score.

The working hypotheses are that (i) alcohol and sulfate levels will have
positive associations with quality, (ii) excessive volatile acidity will be
penalized by tasters, and (iii) density and residual sugar will have limited
importance because the dataset predominantly contains dry wines.

\section{Visualization -- Statistics}
\subsection{Exploratory Statistics}
Table~\ref{tab:summary-stats} reports central tendency and dispersion metrics
for six representative features. Alcohol content and sulfate levels exhibit the
largest relative variability, hinting at potential leverage in differentiating
quality. Volatile acidity shows a pronounced spread, suggesting opportunities to
identify outliers that could harm sensory perception.

\begin{table}[H]
  \centering
  \caption{Summary statistics for representative features.}
  \label{tab:summary-stats}
  \begin{tabular}{l
                  S[table-format=2.3]
                  S[table-format=1.3]
                  S[table-format=1.3]
                  S[table-format=1.3]
                  S[table-format=1.3]
                  S[table-format=1.3]}
    \toprule
    & {Alcohol} & {Volatile acidity} & {Citric acid} & {Sulfates} & {Density} & {pH} \\
    \midrule
    Mean   & 10.423 & 0.528 & 0.271 & 0.658 & 0.997 & 3.311 \\
    Median & 10.200 & 0.520 & 0.260 & 0.620 & 0.997 & 3.310 \\
    Std. dev. & 1.066 & 0.179 & 0.195 & 0.170 & 0.002 & 0.154 \\
    \bottomrule
  \end{tabular}
\end{table}

Figure~\ref{fig:alcohol-quality-scatter} visualizes the relationship between
alcohol content and quality. A clear positive slope is visible, supporting the
hypothesis that higher alcohol concentrations (a proxy for ripeness and body)
are rewarded. The association is strongest for wines rated seven or eight.

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      height=8cm,
      xlabel={Alcohol (\%)},
      ylabel={Quality score},
      ymin=2.5, ymax=8.5,
      grid=both,
      grid style={line width=.1pt, draw=gray!20},
      major grid style={line width=.2pt,draw=gray!50},
      scatter/classes={
        3={mark=*,draw=black,fill=red!60},
        4={mark=*,draw=black,fill=orange!70},
        5={mark=*,draw=black,fill=yellow!80!black},
        6={mark=*,draw=black,fill=green!70!black},
        7={mark=*,draw=black,fill=blue!70},
        8={mark=*,draw=black,fill=purple!70}
      },
      legend style={draw=none,at={(0.02,0.98)},anchor=north west},
      legend cell align=left,
      scatter src=explicit symbolic
    ]
      \addplot+[only marks,opacity=0.35] table[
        x=alcohol,
        y=quality,
        meta=quality
      ] {red_wine_quality.csv};
      \legend{3,4,5,6,7,8}
    \end{axis}
  \end{tikzpicture}
  \caption{Alcohol content versus quality score.}
  \label{fig:alcohol-quality-scatter}
\end{figure}

Table~\ref{tab:quality-means} details mean chemistry measurements by quality
rating. Alcohol and sulfates steadily increase with quality, while volatile
acidity decreases markedly. Total sulfur dioxide peaks at quality five before
declining, suggesting that moderate SO\textsubscript{2} management is favorable
but excessive additions are detrimental.

\begin{table}[H]
  \centering
  \caption{Mean chemistry measurements by quality rating.}
  \label{tab:quality-means}
  \begin{tabular}{c
                  S[table-format=2.3]
                  S[table-format=1.3]
                  S[table-format=1.3]
                  S[table-format=1.3]
                  S[table-format=2.3]}
    \toprule
    Quality & {Alcohol} & {Volatile acidity} & {Citric acid} & {Sulfates} & {Total SO\textsubscript{2}} \\
    \midrule
    3 & 9.955 & 0.885 & 0.171 & 0.570 & 24.900 \\
    4 & 10.265 & 0.694 & 0.174 & 0.596 & 36.245 \\
    5 & 9.900 & 0.577 & 0.244 & 0.621 & 56.514 \\
    6 & 10.630 & 0.497 & 0.274 & 0.675 & 40.870 \\
    7 & 11.466 & 0.404 & 0.375 & 0.741 & 35.020 \\
    8 & 12.094 & 0.423 & 0.391 & 0.768 & 33.444 \\
    \bottomrule
  \end{tabular}
\end{table}

\subsection{Visual Analytics}
Figure~\ref{fig:correlation-bar} summarizes feature correlations with quality.
Alcohol exhibits the largest positive correlation, followed by sulfates and
citric acid, whereas volatile acidity is the strongest negative predictor. These
patterns align with enological expectations: balanced structure and protective
sulfates are beneficial, while acetic notes detract from perceived quality.

\pgfplotstableread[col sep=space]{%
feature correlation
Alcohol 0.476
Sulfates 0.251
Citric_acid 0.226
Fixed_acidity 0.124
Residual_sugar 0.014
Free_sulfur_dioxide -0.051
pH -0.058
Chlorides -0.129
Density -0.175
Total_sulfur_dioxide -0.185
Volatile_acidity -0.391
}{\correlationtable}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      height=7cm,
      ybar,
      bar width=10pt,
      symbolic x coords={Alcohol,Sulfates,Citric_acid,Fixed_acidity,Residual_sugar,Free_sulfur_dioxide,pH,Chlorides,Density,Total_sulfur_dioxide,Volatile_acidity},
      xtick=data,
      xticklabel style={rotate=60,anchor=east},
      xticklabels={Alcohol,Sulfates,Citric acid,Fixed acidity,Residual sugar,Free SO\textsubscript{2},pH,Chlorides,Density,Total SO\textsubscript{2},Volatile acidity},
      ylabel={Correlation with quality},
      ymin=-0.45,
      ymax=0.55,
      enlarge x limits=0.02,
      grid=both,
      grid style={line width=.1pt, draw=gray!15},
      major grid style={line width=.2pt, draw=gray!45}
    ]
      \addplot+ table[x=feature,y=correlation] {\correlationtable};
    \end{axis}
  \end{tikzpicture}
  \caption{Pearson correlation coefficients between features and quality.}
  \label{fig:correlation-bar}
\end{figure}

The acidity--sulfates interaction is further illustrated in
Figures~\ref{fig:vol-acidity-box} and~\ref{fig:acid-sulfur-scatter}. The box plot
highlights how higher-quality wines concentrate at lower volatile acidity
levels, whereas lower-quality wines exhibit heavier tails. The accompanying
scatterplot adds sulfur dioxide into the picture, revealing that excessive
volatile acidity and elevated sulfur dioxide co-occur primarily among lower
quality wines.

\pgfplotsset{compat/show suggested version=false}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      height=7cm,
      boxplot/draw direction=y,
      xtick={1,2,3,4,5,6},
      xticklabels={3,4,5,6,7,8},
      xlabel={Quality score},
      ylabel={Volatile acidity (g/dm\textsuperscript{3})},
      grid=both,
      grid style={line width=.1pt, draw=gray!20},
      major grid style={line width=.2pt,draw=gray!50}
    ]
      \addplot+[
        boxplot prepared={
          lower whisker=0.44,
          lower quartile=0.648,
          median=0.845,
          upper quartile=1.01,
          upper whisker=1.58
        },
      ] coordinates {};
      \addplot+[
        boxplot prepared={
          lower whisker=0.23,
          lower quartile=0.53,
          median=0.67,
          upper quartile=0.87,
          upper whisker=1.13
        },
      ] coordinates {};
      \addplot+[
        boxplot prepared={
          lower whisker=0.18,
          lower quartile=0.46,
          median=0.58,
          upper quartile=0.67,
          upper whisker=1.33
        },
      ] coordinates {};
      \addplot+[
        boxplot prepared={
          lower whisker=0.16,
          lower quartile=0.38,
          median=0.49,
          upper quartile=0.60,
          upper whisker=1.04
        },
      ] coordinates {};
      \addplot+[
        boxplot prepared={
          lower whisker=0.12,
          lower quartile=0.30,
          median=0.37,
          upper quartile=0.485,
          upper whisker=0.915
        },
      ] coordinates {};
      \addplot+[
        boxplot prepared={
          lower whisker=0.26,
          lower quartile=0.335,
          median=0.37,
          upper quartile=0.473,
          upper whisker=0.85
        },
      ] coordinates {};
    \end{axis}
  \end{tikzpicture}
  \caption{Distribution of volatile acidity by quality rating.}
  \label{fig:vol-acidity-box}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      height=7cm,
      xlabel={Volatile acidity (g/dm\textsuperscript{3})},
      ylabel={Total SO\textsubscript{2} (mg/dm\textsuperscript{3})},
      xmin=0, xmax=1.5,
      ymin=-20, ymax=170,
      grid=both,
      grid style={line width=.1pt, draw=gray!20},
      major grid style={line width=.2pt,draw=gray!50},
      scatter/classes={
        3={mark=*,draw=black,fill=red!60},
        4={mark=*,draw=black,fill=orange!70},
        5={mark=*,draw=black,fill=yellow!80!black},
        6={mark=*,draw=black,fill=green!70!black},
        7={mark=*,draw=black,fill=blue!70},
        8={mark=*,draw=black,fill=purple!70}
      },
      legend style={draw=none,at={(0.02,0.98)},anchor=north west},
      legend cell align=left,
      scatter src=explicit symbolic
    ]
      \addplot+[only marks,opacity=0.35] table[
        x=volatile_acidity,
        y=total_sulfur_dioxide,
        meta=quality
      ] {red_wine_quality.csv};
      \legend{3,4,5,6,7,8}
    \end{axis}
  \end{tikzpicture}
  \caption{Joint distribution of volatile acidity and total sulfur dioxide by quality.}
  \label{fig:acid-sulfur-scatter}
\end{figure}

To quantify the interaction, a linear model predicting quality from volatile
acidity, sulphates, and their product yields an \num{0.177} \emph{R}\textsuperscript{2}.
The negative interaction term indicates diminishing returns from sulphates when
volatile acidity is elevated. Table~\ref{tab:interaction-coefs} reports the
coefficients, and Table~\ref{tab:quality-sulfur-response} summarizes how the
response of sulfur dioxide to volatile acidity shifts across quality levels.

\begin{table}[H]
  \centering
  \caption{Linear model coefficients: quality $\sim$ volatile acidity + sulphates + interaction.}
  \label{tab:interaction-coefs}
  \begin{tabular}{l S[table-format=1.3]}
    \toprule
    Term & {Coefficient} \\
    \midrule
    Intercept & 5.684 \\
    Volatile acidity & -1.033 \\
    Sulphates & 1.198 \\
    Volatile acidity $\times$ sulphates & -0.858 \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{table}[H]
  \centering
  \caption{Quality-specific sulfur dioxide response to volatile acidity.}
  \label{tab:quality-sulfur-response}
  \begin{tabular}{c S[table-format=3.2] S[table-format=1.3] S[table-format=1.3]}
    \toprule
    Quality & {Slope (mg/dm\textsuperscript{3} per g/dm\textsuperscript{3})} & {Correlation} & {Mean sulphates} \\
    \midrule
    3 & -27.39 & -0.539 & 0.570 \\
    4 & -17.04 & -0.136 & 0.596 \\
    5 & 1.97 & 0.009 & 0.621 \\
    6 & 7.37 & 0.047 & 0.675 \\
    7 & 4.69 & 0.021 & 0.741 \\
    8 & 76.26 & 0.434 & 0.768 \\
    \bottomrule
  \end{tabular}
\end{table}

\subsection{Dimensionality Reduction and Segmentation Signals}
Principal component analysis (PCA) on the standardized chemistry features
provides a complementary lens for uncovering latent wine profiles. The first two
components explain \SI{45.7}{\percent} of the variance (Table~\ref{tab:pca-variance}).
PC1 contrasts structural acidity (fixed and citric acids, density) against
softer attributes (pH, alcohol), while PC2 is dominated by sulfur management
variables (free and total SO\textsubscript{2}) and residual sugar. These loadings
align with the interaction analysis---wines that balance acidity with measured
sulfur additions tend to score higher. To translate these signals into an
explicit segmentation, the standardized features were clustered with a
deterministic k-means procedure across \numrange{2}{5} segments
(Table~\ref{tab:kmeans-eval}). The two-cluster solution achieved the highest
silhouette (0.207), separating a premium chemistry profile from a mainstream
one.

\pgfmathsetmacro{\meanfixed}{8.319637}
\pgfmathsetmacro{\stdfixed}{1.740552}
\pgfmathsetmacro{\pcafixedone}{-0.489314}
\pgfmathsetmacro{\pcafixedtwo}{-0.110503}
\pgfmathsetmacro{\meanvolatile}{0.527821}
\pgfmathsetmacro{\stdvolatile}{0.179004}
\pgfmathsetmacro{\pcavolone}{0.238584}
\pgfmathsetmacro{\pcavoltwo}{0.274930}
\pgfmathsetmacro{\meancitric}{0.270976}
\pgfmathsetmacro{\stdcitric}{0.194740}
\pgfmathsetmacro{\pcacitone}{-0.463632}
\pgfmathsetmacro{\pcacittwo}{-0.151791}
\pgfmathsetmacro{\meanresidual}{2.538806}
\pgfmathsetmacro{\stdresidual}{1.409487}
\pgfmathsetmacro{\pcaresone}{-0.146107}
\pgfmathsetmacro{\pcaRestwo}{0.272080}
\pgfmathsetmacro{\meanchlorides}{0.087467}
\pgfmathsetmacro{\stdchlorides}{0.047051}
\pgfmathsetmacro{\pcachlorone}{-0.212247}
\pgfmathsetmacro{\pcachlortwo}{0.148052}
\pgfmathsetmacro{\meanfree}{15.874922}
\pgfmathsetmacro{\stdfree}{10.456886}
\pgfmathsetmacro{\pcafreeone}{0.036158}
\pgfmathsetmacro{\pcafreetwo}{0.513567}
\pgfmathsetmacro{\meantotal}{46.467792}
\pgfmathsetmacro{\stdtotal}{32.885037}
\pgfmathsetmacro{\pcatotalone}{-0.023575}
\pgfmathsetmacro{\pcatotaltwo}{0.569487}
\pgfmathsetmacro{\meandensity}{0.996747}
\pgfmathsetmacro{\stddensity}{0.001887}
\pgfmathsetmacro{\pcadensityone}{-0.395353}
\pgfmathsetmacro{\pcadensitytwo}{0.233575}
\pgfmathsetmacro{\meanph}{3.311113}
\pgfmathsetmacro{\stdph}{0.154338}
\pgfmathsetmacro{\pcaphone}{0.438520}
\pgfmathsetmacro{\pcaphtwo}{0.006711}
\pgfmathsetmacro{\meansulphates}{0.658149}
\pgfmathsetmacro{\stdsulphates}{0.169454}
\pgfmathsetmacro{\pcasulphone}{-0.242921}
\pgfmathsetmacro{\pcasulptwo}{-0.037554}
\pgfmathsetmacro{\meanalcohol}{10.422983}
\pgfmathsetmacro{\stdalcohol}{1.065334}
\pgfmathsetmacro{\pcaalcoholone}{0.113232}
\pgfmathsetmacro{\pcaalcoholtwo}{-0.386181}

\pgfplotstableread{red_wine_quality.csv}{\pcatable}
\pgfplotstablecreatecol[
  create col/expr={
    ((\thisrow{fixed_acidity}-\meanfixed)/\stdfixed)*\pcafixedone +
    ((\thisrow{volatile_acidity}-\meanvolatile)/\stdvolatile)*\pcavolone +
    ((\thisrow{citric_acid}-\meancitric)/\stdcitric)*\pcacitone +
    ((\thisrow{residual_sugar}-\meanresidual)/\stdresidual)*\pcaresone +
    ((\thisrow{chlorides}-\meanchlorides)/\stdchlorides)*\pcachlorone +
    ((\thisrow{free_sulfur_dioxide}-\meanfree)/\stdfree)*\pcafreeone +
    ((\thisrow{total_sulfur_dioxide}-\meantotal)/\stdtotal)*\pcatotalone +
    ((\thisrow{density}-\meandensity)/\stddensity)*\pcadensityone +
    ((\thisrow{ph}-\meanph)/\stdph)*\pcaphone +
    ((\thisrow{sulphates}-\meansulphates)/\stdsulphates)*\pcasulphone +
    ((\thisrow{alcohol}-\meanalcohol)/\stdalcohol)*\pcaalcoholone
  }
]{pcone}{\pcatable}
\pgfplotstablecreatecol[
  create col/expr={
    ((\thisrow{fixed_acidity}-\meanfixed)/\stdfixed)*\pcafixedtwo +
    ((\thisrow{volatile_acidity}-\meanvolatile)/\stdvolatile)*\pcavoltwo +
    ((\thisrow{citric_acid}-\meancitric)/\stdcitric)*\pcacittwo +
    ((\thisrow{residual_sugar}-\meanresidual)/\stdresidual)*\pcaRestwo +
    ((\thisrow{chlorides}-\meanchlorides)/\stdchlorides)*\pcachlortwo +
    ((\thisrow{free_sulfur_dioxide}-\meanfree)/\stdfree)*\pcafreetwo +
    ((\thisrow{total_sulfur_dioxide}-\meantotal)/\stdtotal)*\pcatotaltwo +
    ((\thisrow{density}-\meandensity)/\stddensity)*\pcadensitytwo +
    ((\thisrow{ph}-\meanph)/\stdph)*\pcaphtwo +
    ((\thisrow{sulphates}-\meansulphates)/\stdsulphates)*\pcasulptwo +
    ((\thisrow{alcohol}-\meanalcohol)/\stdalcohol)*\pcaalcoholtwo
  }
]{pctwo}{\pcatable}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width=\textwidth,
      height=7cm,
      xlabel={PC1 score},
      ylabel={PC2 score},
      grid=both,
      grid style={line width=.1pt, draw=gray!20},
      major grid style={line width=.2pt,draw=gray!50},
      scatter/classes={
        3={mark=*,draw=black,fill=red!60},
        4={mark=*,draw=black,fill=orange!70},
        5={mark=*,draw=black,fill=yellow!80!black},
        6={mark=*,draw=black,fill=green!70!black},
        7={mark=*,draw=black,fill=blue!70},
        8={mark=*,draw=black,fill=purple!70}
      },
      legend style={draw=none,at={(0.02,0.98)},anchor=north west},
      legend cell align=left,
      scatter src=explicit symbolic
    ]
      \addplot+[only marks,opacity=0.35] table[
        x=pcone,
        y=pctwo,
        meta=quality
      ] {\pcatable};
      \legend{3,4,5,6,7,8}
    \end{axis}
  \end{tikzpicture}
  \caption{Principal component scores colored by quality reveal a compact high-quality cluster.}
  \label{fig:pca-quality}
\end{figure}

Table~\ref{tab:pca-variance} shows the explained variance, while
Table~\ref{tab:pca-loadings} highlights the dominant loadings that differentiate
wine styles along PC1 and PC2. High-quality wines (scores seven and eight) form a
compact cluster with positive PC1 scores and moderate PC2 values, signaling a
blend of balanced acidity, controlled volatile acidity, and measured sulfur
additions. Mapping the k-means assignments back to the source features shows a
premium chemistry profile with higher alcohol, lower volatile acidity, and more
targeted sulphate additions than the mainstream cluster.

\begin{table}[H]
  \centering
  \caption{Explained variance for the leading principal components.}
  \label{tab:pca-variance}
  \begin{tabular}{l S[table-format=1.3]}
    \toprule
    Component & {Variance explained} \\
    \midrule
    PC1 & 0.282 \\
    PC2 & 0.175 \\
    PC3 & 0.141 \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{table}[H]
  \centering
  \caption{Largest absolute loadings for the first two principal components.}
  \label{tab:pca-loadings}
  \begin{tabular}{l S[table-format=1.3] S[table-format=1.3]}
    \toprule
    Feature & {PC1 loading} & {PC2 loading} \\
    \midrule
    Fixed acidity & -0.489 & -0.111 \\
    Citric acid & -0.464 & -0.152 \\
    Density & -0.395 & 0.234 \\
    pH & 0.439 & 0.007 \\
    Volatile acidity & 0.239 & 0.275 \\
    Free SO\textsubscript{2} & 0.036 & 0.514 \\
    Total SO\textsubscript{2} & -0.024 & 0.569 \\
    Residual sugar & -0.146 & 0.272 \\
    Alcohol & 0.113 & -0.386 \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{table}[H]
  \centering
  \caption{K-means evaluation metrics on standardized chemistry features.}
  \label{tab:kmeans-eval}
  \begin{tabular}{c S[table-format=1.3] S[table-format=5.2]}
    \toprule
    Clusters & {Silhouette} & {Inertia} \\
    \midrule
    2 & 0.207 & 14330.94 \\
    3 & 0.172 & 12884.10 \\
    4 & 0.145 & 12044.58 \\
    5 & 0.166 & 10828.29 \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{table}[H]
  \centering
  \caption{Profile of the two-cluster solution (highest silhouette).}
  \label{tab:kmeans-profile}
  \resizebox{\textwidth}{!}{%%
    \begin{tabular}{c S[table-format=4.0] S[table-format=1.2] S[table-format=2.2] S[table-format=1.3] S[table-format=1.3]}
      \toprule
      Cluster & {Size} & {Mean quality} & {Mean alcohol (\%)} & {Mean volatile acidity (g/dm\textsuperscript{3})} & {Mean sulphates (g/dm\textsuperscript{3})} \\
      \midrule
      1 & 638 & 5.870 & 10.578 & 0.418 & 0.745 \\
      0 & 961 & 5.481 & 10.320 & 0.601 & 0.600 \\
      \bottomrule
    \end{tabular}
  }
\end{table}

\section{Research and Analysis Plan -- Results}
The EDA confirms that alcohol, sulfates, and citric acid are leading indicators
of higher sensory scores, while volatile acidity and excessive sulfur dioxide
suppress quality. Observable clusters emerge in the alcohol--quality scatter and
the acidity--sulfur interaction plots. The PCA projection coupled with
deterministic k-means quantifies this structure: the highest-silhouette
segmentation splits the dataset into a \num{638}-wine premium cluster with
quality \num{5.87} and a \num{961}-wine baseline cluster averaging quality
\num{5.48}, differentiated primarily by alcohol, volatile acidity, and sulphate
management (Tables~\ref{tab:kmeans-eval}--\ref{tab:kmeans-profile}).

Future analysis will focus on three directions:
\begin{itemize}
  \item \textbf{Predictive modeling:} Train regularized linear models, gradient boosting, and tree-based ensembles to predict quality. Feature engineering will incorporate interaction terms such as alcohol--density and sulfates--volatile acidity.
  \item \textbf{Segmentation:} Extend beyond the two-cluster baseline by fitting Gaussian mixtures or density-based clustering on standardized features, validating results with silhouette and stability diagnostics, and comparing segment chemistry back to the sensory ratings.
  \item \textbf{Experimental design:} Simulate adjustments to fermentation parameters (e.g., target volatile acidity reductions) to estimate potential quality improvements, leveraging causal inference techniques such as propensity score weighting.
\end{itemize}

Anomalies detected during the EDA include high-chloride wines with suppressed
quality and a small set of high-sulfate, low-quality observations that merit
further laboratory validation. Additional questions raised include the role of
vintage or producer effects (not captured in the dataset) and whether blending
strategies could mitigate identified deficiencies.

\section{Conclusion}
The analysis satisfied the project objectives by (i) describing the dataset and
its feature space, (ii) addressing three prioritized questions with supporting
statistics and visualizations, and (iii) outlining next steps for predictive and
experimental follow-up. Key takeaways include the strong positive influence of
alcohol and sulfates on quality, the detrimental effect of volatile acidity,
and the nuanced relationship between sulfur management and sensory outcomes.
These findings provide actionable guidance for winemakers seeking to optimize
chemistry profiles and lay the groundwork for more advanced modeling.

\section*{Appendix}
Table~\ref{tab:data-snippet} provides a dataset excerpt with headers to
illustrate the tidy structure. The complete CSV file can be downloaded from the
\href{https://archive.ics.uci.edu/dataset/186/wine+quality}{UCI Machine Learning Repository}.

\begin{table}[H]
  \centering
  \caption{Excerpt of the red wine quality dataset.}
  \label{tab:data-snippet}
  \resizebox{\textwidth}{!}{%%
    \pgfplotstabletypeset[
      columns={fixed_acidity,volatile_acidity,citric_acid,residual_sugar,chlorides,free_sulfur_dioxide,total_sulfur_dioxide,density,ph,sulfates,alcohol,quality},
      columns/{fixed_acidity}/.style={column name=Fixed acidity},
      columns/{volatile_acidity}/.style={column name=Volatile acidity},
      columns/{citric_acid}/.style={column name=Citric acid},
      columns/{residual_sugar}/.style={column name=Residual sugar},
      columns/{chlorides}/.style={column name=Chlorides},
      columns/{free_sulfur_dioxide}/.style={column name=Free SO\textsubscript{2}},
      columns/{total_sulfur_dioxide}/.style={column name=Total SO\textsubscript{2}},
      columns/{density}/.style={column name=Density},
      columns/{ph}/.style={column name=pH},
      columns/{sulfates}/.style={column name=Sulfates},
      columns/{alcohol}/.style={column name=Alcohol},
      columns/{quality}/.style={column name=Quality},
      every head row/.style={before row=\toprule,after row=\midrule},
      every last row/.style={after row=\bottomrule},
      row predicate/.code={\ifnum\pgfplotstablerow>14\relax\pgfplotstableuserowfalse\fi}
    ]{red_wine_quality.csv}
  }
\end{table}

\end{document}
